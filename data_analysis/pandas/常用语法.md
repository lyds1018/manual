# 📘 Pandas 常用语法

## 1. 导入与基本信息

``` python
import pandas as pd

# 读取 CSV 文件
df = pd.read_csv("data.csv")

# 查看前几行（默认 5 行）
print(df.head())

# 查看后几行
print(df.tail(3))

# 查看数据基本信息（列名、非空数、数据类型等）
print(df.info())

# 查看描述性统计
print(df.describe())

# 查看形状 (行数, 列数)
print(df.shape)

# 查看列名
print(df.columns)

# 查看索引
print(df.index)
```

## 2. DataFrame 与 Series 创建

``` python
# 创建 Series
s1 = pd.Series([1, 2, 3, 4], name="numbers")
# 自定义索引
index = [4, 3, 2, 1]
s2 = pd.Series([1, 2, 3, 4], index=index, name='A')


# 创建 DataFrame
# 通过字典
df1 = pd.DataFrame({
    "name": ["Tom", "Jerry", "Spike"],
    "age": [20, 22, 23],
    "score": [90, 85, 88]
})
df2 = pd.DataFrame([{"num": 1, "name": 'pp'}, {"num": 2, "name": 'qq'}])
# 通过列表
df3 = pd.DataFrame([['Google', 10], ['Runoob', 12], ['Wiki', 13]], 
                   columns=['Site', 'Age'])
```

## 3. 数据选取与切片

``` python
# 按列取值
print(df["name"])
print(df[["name", "age"]])

# 按行取值 (loc 按标签, iloc 按位置)
print(df.loc[0])        # 标签0所在行
print(df.iloc[1])       # 第二行

# 行列同时选择
print(df.loc[0, "name"])     # 标签0所在行, name列
print(df.iloc[1, 2])         # 第二行, 第三列

# 切片
print(df.iloc[0:2])     # 前两行
print(df.iloc[0:2,1:3])     # 前两行, 2-3列
```

## 4. 增加/删除列

``` python
# 新增列
df["city"] = "Shanghai"				# 增加常量列
df["passed"] = df["score"] > 85		# 根据其他列, 逻辑运算
df["num"] = df["score"] * 85		# 根据其他列, 算术运算

# 删除列
df = df.drop(columns=["city"])
```

## 6. 缺失值处理

``` python
# 检查缺失值
print(df.isnull())
print(np.any(df.isnull())==True)

# 删除缺失值
df = df.dropna()

# 填充缺失值
df = df.fillna(0)
```

## 7. 排序

``` python
# 按列排序
df = df.sort_values(by="age", ascending=False)		# 根据指定列值排序, 默认升序
df = df.sort_index(axis=0)							# 根据索引排序
```

## 8. 分组与聚合

``` python
# 按 Department 分组，求平均 Salary
grouped1 = df.groupby('Department')['Salary'].mean()

# 多个聚合操作
grouped2 = df.groupby("Department").agg({"age": "max", "Salary": "mean"})
grouped3 = df.groupby('Department').agg({'Salary': ['mean', 'sum']})
```

## 9. 合并与拼接

``` python
# 按列拼接(横向拼接)
df1 = pd.DataFrame({'name': ['Alice', 'Bob', 'Charlie'], 'score': [90, 80, 95]})
df2 = pd.DataFrame({'age': [25, 24, 23], 'gender': ['F', 'M', 'M']})
df_concat = pd.concat([df1, df2], axis=1)

# 按行拼接(纵向拼接)
df1 = pd.DataFrame({'name': ['Alice', 'Bob'], 'score': [90, 80]})
df2 = pd.DataFrame({'name': ['Charlie', 'David'], 'score': [95, 88]})
df_concat = pd.concat([df1, df2], axis=0, ignore_index=True)

# 按 key 合并
df1 = pd.DataFrame({"name": ["Tom", "Jerry"], "gender": ["M", "M"]})
df2 = pd.DataFrame({'name': ['Tom', 'Jerry', 'Charlie'], 'score': [90, 80, 95]})
df_merged = pd.merge(df1, df2, on='name', how='inner')	# 内连接
df_merged = pd.merge(df1, df2, on='name', how='outer')  # 外连接（存在含缺失值的行）
```

## 10. 文件读写

``` python
# 读取 CSV
df = pd.read_csv("data.csv")

# 写入 CSV
df.to_csv("out.csv", index=False)

# Excel
df = pd.read_excel("data.xlsx")
df.to_excel("out.xlsx", index=False)
```
